
function [vecpow]=ps_rip2(p,w)

[ran]=rip_select(p);
p=p(ran);

    for j=1:length(p)
        F = fft(p{j}(w,:)); 
        pow = F.*conj(F);
      vecpow(1,j)=sum(pow);
      
        F2 = fft(p{j}(w,:)); 
        pow2 = F2.*conj(F2);
      vecpow2(1,j)=sum(pow2);
      
    end
end

[ran]=rip_select(q)